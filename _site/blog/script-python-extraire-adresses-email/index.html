<!DOCTYPE html>
<html lang="fr">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Email extractor :  un script python pour extraire les adresses email depuis un fichier | crowd42's blog</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/css/bootstrap-3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    


    <link rel="shortcut icon" href="/images/favicon.ico">

    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="feed/"> 

</head>


    <body>
      <div class="container">

        <header class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <h1 class="">crowd42's blog</h1>
    <p>
    <span class="reserved">char</span> nick[<span class="number">7</span>] = <span class="string">"crowd42"</span>;
    </p>
    <p>
    printf(<a href="https://github.com/crowd42" target="_blank"><span class="string">"https://github.com/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>

    <p>
    printf(<a href="https://mastodon.social/crowd42"
      target="_blank"><span class="string">"https://mastodon.social/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>

    <p>
    printf(<a href="https://keybase.io/crowd42"
      target="_blank"><span class="string">"https://keybase.io/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>


     <p>
    printf(<a href="https://twitter.com/crowd42"
      target="_blank"><span class="string">"https://twitter.com/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>

    <p>
    printf(<span class="string">"<span class="reserved">%s\x40</span>riseup<span class="reserved">\x2e\\\b</span>net<span class="reserved">\n</span>"</span>,nick);
    </p>
    <!-- <p>
            printf(<a href="https://crowd42.github.io" target="_blank"><span class="string">"https://<span class="reserved">%s</span>.github.io<span class="reserved">\n</span>"</span></a>,nick);
        </p> -->
    <p>
    puts(<a href="misc/pubkey.gpg.txt" target="_blank"><span
        class="string">"0xdc 5a6d b445 976d 60"</span></a>);
    </p>
  </div>
</header>

<div class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <div class="menu">
      <ul>
          <li><a href="/">home</a></li>
          <li><a href="/blog/">blog</a></li>
          <li> <a href="/astuces/">astuces</a></li>
          <li><a href="/books/">books</a></li>
          <li><a href="/casts">*casts</a></li>
          <li><a href="/movies">movies</a></li>
          <li><a href="/talks">talks</a></li>
          <li><a href="/zines">*zines</a></li>
          <li><a href="/ressources">ressources</a></li>
          <li><a href="/feed">feed</a></li>
          <li><a href="https://liberapay.com/~29921/donate">donate</a></li>
      </ul>
    </div>
  </div>
</div>



        <div class="row">
          <div class="col-lg-8 col-lg-offset-2">
            <main>
            <div class="post">

  <header class="post-header">
    <h1>Email extractor :  un script python pour extraire les adresses email depuis un fichier</h1>
  </header>

  <article class="post-content">
  <div class="post">

  <header class="post-header">
    <p class="meta">
        Oct 17, 2017
        
        
        •
        <span><a href="/category/#python" class="reserved">python</a>,</span><span><a href="/category/#infosec" class="reserved">infosec</a>,</span><span><a href="/category/#penetration testing" class="reserved">penetration testing</a>,</span><span><a href="/category/#dev" class="reserved">dev</a></span>
    </p>
  </header>

  <article class="post-content">
  <h3 id="update">Update</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Voilà, je me suis enfin bouger les fesses et j'ai réecrit le script :-). Il est aussi dispo sur mon compte [Gitlab \[0\]][0]
</code></pre></div></div>
<p>Lors de la pahse de reconnaissance d’une de mes missions de <a href="https://en.wikipedia.org/wiki/Penetration_test">test d’intrusion (penetration testing)[1]</a>, il m’arrive souvent de tomber sur des fichiers contenant des centaines d’adresses emails, numéro de tél, adresses postales… et plein d’autres informations plus au moins utiles.</p>

<p>Et comme tout “informaticien” qui se respecte, ma fainéantise n’a pas d’égal, donc au lieu d’extraire avec des copier/coller les adresses emails pour les utiliser plus tard dans mes compagnes de phishing, j’avais écrit un petit script en python de quelques lignes qui le fait à ma place ey que j’ai décidé de partager aujourd’hui.</p>

<p>Le script connait quelques lacunes (et bugs) mais comme il faisait exactement ce que je lui ai demandé, je n’ai pas cherché à l’étoffer ou l’améliorer.</p>

<p>Son utilisation est simple :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python email_extractor.py input_file output_file
</code></pre></div></div>

<p>Où “input_file” est le fichier source contenant les adresses emails et output_file est le fichier où seront sauvegardés les emails extrait du fichier.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#!/usr/bin/env python
# coding:utf-8
</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">"Extract file"</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-i'</span><span class="p">,</span> <span class="s">'--input_file'</span><span class="p">)</span>
<span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-o'</span><span class="p">,</span> <span class="s">'--output_file'</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">.</span><span class="n">input_file</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">args</span><span class="p">.</span><span class="n">output_file</span><span class="p">:</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">print_help</span><span class="p">()</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>

<span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="sa">r</span><span class="s">'[\w\.-]+@[\w\.-]+'</span><span class="p">)</span>

<span class="c1"># The input file
</span><span class="n">input_file</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">input_file</span>

<span class="c1"># The output file.
</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">output_file</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">emailfile</span><span class="p">:</span>
        <span class="n">email_list</span> <span class="o">=</span> <span class="n">emailfile</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">lower</span><span class="p">()</span>
        <span class="c1"># Here re.findall() returns a list of all the found email strings
</span>        <span class="n">emails</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">email_list</span><span class="p">)</span>
        <span class="c1"># Write the emails into the file, one per line
</span>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">email</span> <span class="ow">in</span> <span class="n">emails</span><span class="p">:</span>
                <span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">email</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'this file doesn</span><span class="se">\'</span><span class="s">t exist'</span><span class="p">)</span></code></pre></figure>

<h3 id="liens">Liens</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[0]: http://gitlab.com/crowd42/email-extractor
[1]: https://en.wikipedia.org/wiki/Penetration_test
</code></pre></div></div>


  </article>
   

    
    
        
            
                
                <h1>Sur le même sujet</h1>
                <ul>
                
                <li>
                    <a href="http://localhost:4000/blog/liste-podcasts-python/">Une liste des podcasts python
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/blog/microsoft-mots-de-passe-toute-une-histoire/">Microsoft et les mots de passe, toute une histoire
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/-blog/script-python-sites-web-meme-adresse-ip/">Un petit script pour récupérer les URLs des sites web hébergés sur la même adresse IP
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/blog/windows-credential-guard-mimikatz/">Windows Credential Guard et Mimikatz
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/blog/meltdown-spectre/">Deux points qui me tracassent à propos de meltdown et spectre
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/blog/full-disclosure-etihad-airways/">Full Disclosure : Des emails et mots de passe de la compagnie aérienne Etihad Airways dans l'air
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    


    </ul>


	<p class="feed-recomendation">
		Si vous avez aimé ce billet, vous pouvez vous inscrire au <a href="feed/">flux RSS</a> !
	</p>

  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'crowd42s-blog-1';
    var disqus_config = function () {
        this.page.identifier = "/blog/script-python-extraire-adresses-email/";
    };
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




</div>

  </article>

</div>

            </main>
          </div>
        </div>

        <div class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <footer>
      Propulsé fièrement par Jekyll!
    </footer>
  </div>
</div>


      </div>
    </body>
</html>
