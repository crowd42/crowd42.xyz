<!DOCTYPE html>
<html lang="fr">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Exploiter la vulnérabilité PHPMailer CVE-2016-10033 | crowd42's blog</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/css/bootstrap-3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    


    <link rel="shortcut icon" href="/images/favicon.ico">

    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="feed/"> 

</head>


    <body>
      <div class="container">

        <header class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <h1 class="">crowd42's blog</h1>
    <p>
    <span class="reserved">char</span> nick[<span class="number">7</span>] = <span class="string">"crowd42"</span>;
    </p>
    <p>
    printf(<a href="https://github.com/crowd42" target="_blank"><span class="string">"https://github.com/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>

    <p>
    printf(<a href="https://mastodon.social/crowd42"
      target="_blank"><span class="string">"https://mastodon.social/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>

    <p>
    printf(<a href="https://keybase.io/crowd42"
      target="_blank"><span class="string">"https://keybase.io/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>


     <p>
    printf(<a href="https://twitter.com/crowd42"
      target="_blank"><span class="string">"https://twitter.com/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>

    <p>
    printf(<span class="string">"<span class="reserved">%s\x40</span>riseup<span class="reserved">\x2e\\\b</span>net<span class="reserved">\n</span>"</span>,nick);
    </p>
    <!-- <p>
            printf(<a href="https://crowd42.github.io" target="_blank"><span class="string">"https://<span class="reserved">%s</span>.github.io<span class="reserved">\n</span>"</span></a>,nick);
        </p> -->
    <p>
    puts(<a href="misc/pubkey.gpg.txt" target="_blank"><span
        class="string">"0xdc 5a6d b445 976d 60"</span></a>);
    </p>
  </div>
</header>

<div class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <div class="menu">
      <ul>
          <li><a href="/">home</a></li>
          <li><a href="/blog/">blog</a></li>
          <li> <a href="/astuces/">astuces</a></li>
          <li><a href="/books/">books</a></li>
          <li><a href="/casts">*casts</a></li>
          <li><a href="/movies">movies</a></li>
          <li><a href="/talks">talks</a></li>
          <li><a href="/zines">*zines</a></li>
          <li><a href="/ressources">ressources</a></li>
          <li><a href="/feed">feed</a></li>
          <li><a href="https://liberapay.com/~29921/donate">donate</a></li>
      </ul>
    </div>
  </div>
</div>



        <div class="row">
          <div class="col-lg-8 col-lg-offset-2">
            <main>
            <div class="post">

  <header class="post-header">
    <h1>Exploiter la vulnérabilité PHPMailer CVE-2016-10033</h1>
  </header>

  <article class="post-content">
  <div class="post">

  <header class="post-header">
    <p class="meta">
        Dec 30, 2016
        
        
        •
        <span><a href="/category/#exploit" class="reserved">exploit</a>,</span><span><a href="/category/#infosec" class="reserved">infosec</a>,</span><span><a href="/category/#hacking" class="reserved">hacking</a>,</span><span><a href="/category/#phpmailer" class="reserved">phpmailer</a></span>
    </p>
  </header>

  <article class="post-content">
  <p>Imaginez plus 9 de millions sites web qui peuvent être piratés en l’espace de
quelques secondes !</p>

<p>Si vous avez suivé l’actualité infosec sur Twitter ou sur les sites spécialisés
ces derniers jours, vous avez alors sûrement entendu parler de la vulnérabilité découverte par le
   chercheur en sécurité informatique polonais <a href="https://twitter.com/dawid_golunski">David Golunski [0]</a> touchant la
   bibliothèque <a href="https://github.com/PHPMailer/PHPMailer">PHPMailer [1]</a>, une des plus populaires libs et les plus utilisées de
   PHP. La faile affecte toutes les versions antérieure à 5.2.18, si un
   attaquant malveillant l’exploite, il pourra alors exécuter du <a href="https://en.wikipedia.org/wiki/Arbitrary_code_execution">code arbitraire à distance (RCE) [2]</a>.</p>

<p>Cette bibliothèque est utilisée par Wordpress, Drupal, Joomla, SugarCRM, etc.
   Je vous laisse imaginer les dégâts que ça vous causer.</p>

<p>Comme je l’écrit au début, cette faille peut être exploiter en quelques secondes
et avec une facilité ahurissante. Pour vous vous en donner un exemple, on va
utiliser une image docker que vous pouvez installer en exécutant la commande
suivante :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker pull vulnerables/cve-2016-10033
</code></pre></div></div>

<p>Ensuite vous la lancez avec cette commande :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker run --rm -it -p 8080:80 vulnerables/cve-2016-10033
</code></pre></div></div>
<p><img src="/images/posts/2016/phpmailer.png" alt="Screenshot PHPMailer" title="Screenshot - PHPMailer" /></p>

<p>Plusieurs exploit ont été publié depuis que la vulnérabilité a été rendu
publique. Dans notre exemple on va utiliser celui qui a été écrit par <a href="https://github.com/opsxcq/exploit-CVE-2016-10033">opsxcq
[3]</a></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone https://github.com/opsxcq/exploit-CVE-2016-10033
</code></pre></div></div>
<p><img src="/images/posts/2016/exploit.png" alt="Screenshot exploit phpmailer" title="Screenshot - Exploit PHPMailer" /></p>

<p>Et voilà, vous avez votre remote shell, maintenant vous essayer d’élever vos
privilèges en exécutant un des scripts que j’ai évoqué dans <a href="http://localhost:4000blog/4-scripts-elevation-privileges/">ce billet par
exemple [4]</a>.</p>

<p>P.S Si vous n’avez pas docker, vous pouvez suivre <a href="https://docs.docker.com/engine/installation/">un de ces guides pour l’installer
[5]</a>.</p>

<h3 id="liens">Liens</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[0]: https://twitter.com/dawid_golunski
[1]: https://github.com/PHPMailer/PHPMailer
[2]: https://en.wikipedia.org/wiki/Arbitrary_code_execution
[3]: https://github.com/opsxcq/exploit-CVE-2016-10033
[4]: http://localhost:4000blog/4-scripts-elevation-privileges/
[5]: https://docs.docker.com/engine/installation/
</code></pre></div></div>


  </article>
   

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
                
                <h1>Sur le même sujet</h1>
                <ul>
                
                <li>
                    <a href="http://localhost:4000/blog/microsoft-mots-de-passe-toute-une-histoire/">Microsoft et les mots de passe, toute une histoire
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/-blog/script-python-sites-web-meme-adresse-ip/">Un petit script pour récupérer les URLs des sites web hébergés sur la même adresse IP
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/blog/windows-credential-guard-mimikatz/">Windows Credential Guard et Mimikatz
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/blog/meltdown-spectre/">Deux points qui me tracassent à propos de meltdown et spectre
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/blog/full-disclosure-etihad-airways/">Full Disclosure : Des emails et mots de passe de la compagnie aérienne Etihad Airways dans l'air
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
                
                <li>
                    <a href="http://localhost:4000/comment-jai-pu-gagner-acces-administrateur-serveur-windows-grace-google/">Comment j'ai pu gagner un accès administrateur sur un serveur Windows 2012 grâce à Google
                    
                    </a>
                </li>
                
                
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    

    
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    
        
            
        
            
        
            
        
            
        
    


    </ul>


	<p class="feed-recomendation">
		Si vous avez aimé ce billet, vous pouvez vous inscrire au <a href="feed/">flux RSS</a> !
	</p>

  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'crowd42s-blog-1';
    var disqus_config = function () {
        this.page.identifier = "/blog/exploiter-vul-phpmailer-cve-2016-10033/";
    };
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




</div>

  </article>

</div>

            </main>
          </div>
        </div>

        <div class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <footer>
      Propulsé fièrement par Jekyll!
    </footer>
  </div>
</div>


      </div>
    </body>
</html>
